# 测试计划

## 1. 功能测试

### 1.1 YARA 规则管理

#### 测试用例 1: 创建规则
- **目标**: 验证创建 YARA 规则功能
- **步骤**:
  1. 访问规则管理页面
  2. 点击"新建规则"
  3. 输入规则信息
  4. 提交表单
- **预期**: 规则创建成功,显示在列表中

#### 测试用例 2: 上传规则文件
- **目标**: 验证批量上传规则
- **步骤**:
  1. 准备 .yar 文件
  2. 点击"上传规则文件"
  3. 选择文件上传
- **预期**: 规则解析成功并保存

#### 测试用例 3: 规则验证
- **目标**: 验证规则语法检查
- **步骤**:
  1. 创建包含语法错误的规则
  2. 提交规则
- **预期**: 显示语法错误提示

### 1.2 文件扫描

#### 测试用例 4: 单文件扫描
- **目标**: 验证单文件扫描功能
- **步骤**:
  1. 上传测试文件
  2. 执行扫描
  3. 查看结果
- **预期**: 正确识别恶意/安全文件

#### 测试用例 5: 批量扫描
- **目标**: 验证目录扫描功能
- **步骤**:
  1. 指定测试目录
  2. 启动扫描任务
  3. 监控进度
- **预期**: 所有文件被扫描,结果准确

### 1.3 检测报告

#### 测试用例 6: 统计数据
- **目标**: 验证统计数据准确性
- **步骤**:
  1. 执行多次扫描
  2. 访问报告页面
  3. 查看统计数据
- **预期**: 数据与实际扫描结果一致

## 2. 性能测试

### 2.1 规则加载性能

#### 测试用例 7: 大量规则加载
- **目标**: 测试系统处理大量规则的能力
- **测试数据**: 1000+ YARA 规则
- **测试指标**:
  - 加载时间 < 10秒
  - 内存占用 < 1GB
  - CPU 使用率 < 80%

### 2.2 扫描性能

#### 测试用例 8: 大文件扫描
- **目标**: 测试大文件扫描性能
- **测试数据**: 100MB+ 文件
- **测试指标**:
  - 扫描时间 < 30秒
  - 内存占用稳定
  - 无内存泄漏

#### 测试用例 9: 批量文件扫描
- **目标**: 测试批量扫描性能
- **测试数据**: 10000+ 文件
- **测试指标**:
  - 扫描速度 > 100 文件/秒
  - 支持并发扫描
  - 进度更新准确

## 3. 准确性测试

### 3.1 检测准确率

#### 测试样本集
1. **已知恶意样本**: 100个
   - WannaCry
   - Petya
   - TrickBot
   - 其他常见恶意软件

2. **正常文件**: 1000个
   - 系统文件
   - 常用软件
   - 开源项目

#### 测试指标

| 指标 | 计算公式 | 目标值 |
|------|---------|--------|
| 准确率 (Accuracy) | (TP + TN) / (TP + TN + FP + FN) | > 95% |
| 召回率 (Recall) | TP / (TP + FN) | > 90% |
| 精确率 (Precision) | TP / (TP + FP) | > 95% |
| F1 分数 | 2 * (Precision * Recall) / (Precision + Recall) | > 92% |
| 误报率 (FPR) | FP / (FP + TN) | < 5% |
| 漏报率 (FNR) | FN / (FN + TP) | < 10% |

**说明**:
- TP (True Positive): 正确检测为恶意
- TN (True Negative): 正确识别为安全
- FP (False Positive): 误报 (安全文件被误判为恶意)
- FN (False Negative): 漏报 (恶意文件未被检测)

### 3.2 规则有效性测试

#### 测试用例 10: 规则匹配测试
- **目标**: 验证每条规则的有效性
- **步骤**:
  1. 为每条规则准备对应的测试样本
  2. 执行扫描
  3. 记录匹配结果
- **预期**: 规则能正确匹配目标样本

## 4. 安全测试

### 4.1 认证授权

#### 测试用例 11: 未授权访问
- **目标**: 验证 API 保护
- **步骤**:
  1. 不带 Token 访问 API
  2. 使用过期 Token 访问
- **预期**: 返回 401 未授权错误

### 4.2 输入验证

#### 测试用例 12: SQL 注入
- **目标**: 验证 SQL 注入防护
- **步骤**:
  1. 在输入框注入 SQL 语句
  2. 提交表单
- **预期**: 输入被正确转义,无法注入

#### 测试用例 13: XSS 攻击
- **目标**: 验证 XSS 防护
- **步骤**:
  1. 在输入框注入脚本
  2. 查看页面渲染
- **预期**: 脚本被转义,不执行

## 5. 兼容性测试

### 5.1 浏览器兼容性

- Chrome (最新版)
- Firefox (最新版)
- Safari (最新版)
- Edge (最新版)

### 5.2 操作系统兼容性

- Windows 10/11
- macOS 12+
- Ubuntu 20.04+

### 5.3 YARA 版本兼容性

- YARA 4.0+
- YARA 4.1+
- YARA 4.2+
- YARA 4.5+ (推荐)

## 6. 测试环境

### 6.1 硬件要求

- CPU: 4核+
- 内存: 8GB+
- 磁盘: 100GB+

### 6.2 软件环境

- Python 3.8+
- Node.js 16+
- PostgreSQL 12+ / SQLite
- Redis 6+

## 7. 测试数据

### 7.1 测试样本

存放路径: `tests/samples/`

```
samples/
├── malware/          # 恶意样本
│   ├── ransomware/
│   ├── trojan/
│   ├── backdoor/
│   └── worm/
└── benign/           # 正常文件
    ├── executables/
    ├── documents/
    └── archives/
```

### 7.2 测试规则

存放路径: `tests/rules/`

```
rules/
├── test_basic.yar        # 基础测试规则
├── test_performance.yar  # 性能测试规则
└── test_accuracy.yar     # 准确性测试规则
```

## 8. 测试报告模板

### 测试执行记录

| 测试用例 | 执行日期 | 执行人 | 结果 | 备注 |
|---------|---------|-------|------|------|
| TC-001  | 2025-11-02 | 张三 | ✅ 通过 | - |
| TC-002  | 2025-11-02 | 李四 | ❌ 失败 | Bug #123 |

### 准确性测试报告

```
测试时间: 2025-11-02
测试样本: 1100个 (100恶意 + 1000正常)

结果统计:
- TP: 92  (正确检测恶意文件)
- TN: 965 (正确识别安全文件)
- FP: 35  (误报)
- FN: 8   (漏报)

性能指标:
- 准确率: 96.09%
- 召回率: 92.00%
- 精确率: 72.44%
- F1分数: 81.06%
- 误报率: 3.50%
- 漏报率: 8.00%

结论: 系统整体表现良好,但需要降低误报率
```

## 9. Bug 跟踪

使用 GitHub Issues 跟踪问题:

- Bug 模板
- Feature Request 模板
- 优先级标签 (Critical, High, Medium, Low)

## 10. 持续集成

### 自动化测试

```yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Backend Tests
        run: |
          cd backend
          pip install -r requirements.txt
          pytest
      - name: Run Frontend Tests
        run: |
          cd frontend
          npm install
          npm test
```

## 参考资源

- [软件测试标准](https://www.iso.org/standard/45142.html)
- [OWASP 测试指南](https://owasp.org/www-project-web-security-testing-guide/)
- [性能测试最佳实践](https://www.perfmatrix.com/performance-testing-best-practices/)
