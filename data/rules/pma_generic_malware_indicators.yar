/*
    YARA-X Rule for PMA_Generic_Malware_Indicators
    Chapter: Generic
    Sample: PMA_Generic_Malware_Indicators
    Malware Type: Malware
    
    Description: Generic indicators for Practical Malware Analysis samples
    
    WARNING: Educational malware sample - DO NOT RUN!
*/

import "pe"

rule PMA_Generic_Malware_Indicators
{
    meta:
        description = "Generic indicators for Practical Malware Analysis samples"
        severity = "medium"
        
    strings:
        $pma1 = "practicalmalwareanalysis" nocase
        $pma2 = "malwareanalysisbook" nocase
        $pma3 = "Lab" nocase wide ascii
        $suspicious1 = "vmx32to64.exe" nocase
        $suspicious2 = "spoolvxx32.exe" nocase
        
    condition:
        uint16(0) == 0x5A4D and
        2 of them
}